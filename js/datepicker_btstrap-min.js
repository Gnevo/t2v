!function(t){var e=(t(window),function(e,s){if(this.element=t(e),this.format=i.parseFormat(s.format||this.element.data("date-format")||"mm/dd/yyyy"),this.picker=t(i.template).appendTo("#main_content #external_wrapper").on({click:t.proxy(this.click,this)}),this.isInput=this.element.is("input"),this.component=this.element.is(".date")?this.element.find(".add-on"):!1,this.isInput?this.element.on({focus:t.proxy(this.show,this),keyup:t.proxy(this.update,this)}):this.component?this.component.on("click",t.proxy(this.show,this)):this.element.on("click",t.proxy(this.show,this)),this.minViewMode=s.minViewMode||this.element.data("date-minviewmode")||0,"string"==typeof this.minViewMode)switch(this.minViewMode){case"months":this.minViewMode=1;break;case"years":this.minViewMode=2;break;default:this.minViewMode=0}if(this.viewMode=s.viewMode||this.element.data("date-viewmode")||0,"string"==typeof this.viewMode)switch(this.viewMode){case"months":this.viewMode=1;break;case"years":this.viewMode=2;break;default:this.viewMode=0}this.startViewMode=this.viewMode,this.weekStart=s.weekStart||this.element.data("date-weekstart")||0,this.weekEnd=0===this.weekStart?6:this.weekStart-1,this.onRender=s.onRender,this.highlight_months=s.highlight_months||[],this.fillDow(),this.fillMonths(),this.update(),this.showMode()});e.prototype={constructor:e,show:function(e){this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.place(),t(window).on("resize",t.proxy(this.place,this)),e&&(e.stopPropagation(),e.preventDefault()),!this.isInput;var i=this;t(document).on("mousedown",function(e){0==t(e.target).closest(".datepicker-bt").length&&i.hide()}),this.element.trigger({type:"show",date:this.date})},hide:function(){this.picker.hide(),t(window).off("resize",this.place),this.viewMode=this.startViewMode,this.showMode(),this.isInput||t(document).off("mousedown",this.hide),this.element.trigger({type:"hide",date:this.date})},set:function(){var t=i.formatDate(this.date,this.format);this.isInput?this.element.prop("value",t):(this.component&&this.element.find("input").prop("value",t),this.element.data("date",t))},setValue:function(t){this.date="string"==typeof t?i.parseDate(t,this.format):new Date(t),this.set(),this.viewDate=new Date(this.date.getFullYear(),this.date.getMonth(),1,0,0,0,0),this.fill()},place:function(){var t=this.component?this.component.offset():this.element.offset();this.picker.css({top:t.top,left:t.left})},update:function(t){this.date=i.parseDate("string"==typeof t?t:this.isInput?this.element.prop("value"):this.element.data("date"),this.format),this.viewDate=new Date(this.date.getFullYear(),this.date.getMonth(),1,0,0,0,0),this.fill()},inArray:function(t,e){for(var i=e.length,s=0;i>s;s++)if(e[s]==t)return!0;return!1},fillDow:function(){for(var t=this.weekStart,e="<tr>";t<this.weekStart+7;)e+='<th class="dow">'+i.dates.daysMin[t++%7]+"</th>";e+="</tr>",this.picker.find(".datepicker-bt-days thead").append(e)},fillMonths:function(){for(var t="",e=0;12>e;)t+='<span class="month">'+i.dates.monthsShort[e++]+"</span>";this.picker.find(".datepicker-bt-months td").append(t)},fill:function(){var e=new Date(this.viewDate),s=e.getFullYear(),a=e.getMonth(),n=this.date.valueOf();this.picker.find(".datepicker-bt-days th:eq(1)").text(i.dates.months[a]+" "+s);var h=new Date(s,a-1,28,0,0,0,0),o=i.getDaysInMonth(h.getFullYear(),h.getMonth());h.setDate(o),h.setDate(o-(h.getDay()-this.weekStart+7)%7);var r=new Date(h);r.setDate(r.getDate()+42),r=r.valueOf();for(var d,l,c,p=[];h.valueOf()<r;)h.getDay()===this.weekStart&&p.push("<tr>"),d=this.onRender(h),l=h.getFullYear(),c=h.getMonth(),a>c&&l===s||s>l?d+=" old":(c>a&&l===s||l>s)&&(d+=" new"),h.valueOf()===n&&(d+=" active"),p.push('<td class="day '+d+'">'+h.getDate()+"</td>"),h.getDay()===this.weekEnd&&p.push("</tr>"),h.setDate(h.getDate()+1);this.picker.find(".datepicker-bt-days tbody").empty().append(p.join(""));var m=this.date.getFullYear(),f=this.picker.find(".datepicker-bt-months").find("th:eq(1)").text(s).end().find("span").removeClass("active").removeClass("highlight");m===s&&f.eq(this.date.getMonth()).addClass("active"),Object.size(this.highlight_months)>0&&t.each(this.highlight_months,function(e,i){e==s&&Object.size(i)>0&&t.each(i,function(t,e){f.eq(e-1).addClass("highlight")})}),p="",s=10*parseInt(s/10,10);var u=this.picker.find(".datepicker-bt-years").find("th:eq(1)").text(s+"-"+(s+9)).end().find("td");s-=1;for(var w=(Object.keys(this.highlight_months),-1);11>w;w++)p+='<span class="year'+(-1===w||10===w?" old":"")+(m===s?" active":"")+(this.inArray(s,Object.keys(this.highlight_months))?" highlight":"")+'">'+s+"</span>",s+=1;u.html(p)},click:function(e){e.stopPropagation(),e.preventDefault();var s=t(e.target).closest("span, td, th");if(1===s.length)switch(s[0].nodeName.toLowerCase()){case"th":switch(s[0].className){case"switch":this.showMode(1);break;case"prev":case"next":this.viewDate["set"+i.modes[this.viewMode].navFnc].call(this.viewDate,this.viewDate["get"+i.modes[this.viewMode].navFnc].call(this.viewDate)+i.modes[this.viewMode].navStep*("prev"===s[0].className?-1:1)),this.fill(),this.set()}break;case"span":if(s.is(".month")){var a=s.parent().find("span").index(s);this.viewDate.setMonth(a)}else{var n=parseInt(s.text(),10)||0;this.viewDate.setFullYear(n)}0!==this.viewMode&&(this.date=new Date(this.viewDate),this.element.trigger({type:"changeDate",date:this.date,viewMode:i.modes[this.viewMode].clsName})),this.showMode(-1),this.fill(),this.set();break;case"td":if(s.is(".day")&&!s.is(".disabled")){var h=parseInt(s.text(),10)||1,a=this.viewDate.getMonth();s.is(".old")?a-=1:s.is(".new")&&(a+=1);var n=this.viewDate.getFullYear();this.date=new Date(n,a,h,0,0,0,0),this.viewDate=new Date(n,a,Math.min(28,h),0,0,0,0),this.fill(),this.set(),this.element.trigger({type:"changeDate",date:this.date,viewMode:i.modes[this.viewMode].clsName})}}},mousedown:function(t){t.stopPropagation(),t.preventDefault()},showMode:function(t){t&&(this.viewMode=Math.max(this.minViewMode,Math.min(2,this.viewMode+t))),this.picker.find(">div").hide().filter(".datepicker-bt-"+i.modes[this.viewMode].clsName).show()}},t.fn.datepicker_btstrap=function(i,s){return this.each(function(){var a=t(this),n=a.data("datepicker"),h="object"==typeof i&&i;n||a.data("datepicker",n=new e(this,t.extend({},t.fn.datepicker_btstrap.defaults,h))),"string"==typeof i&&n[i](s)})},t.fn.datepicker_btstrap.defaults={onRender:function(){return""}},t.fn.datepicker_btstrap.Constructor=e;var i={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],dates:{days:["Söndag","Måndag","Tisdag","Onsdag","Torsdag","Fredag","Lördag","Söndag"],daysShort:["Sön","Mån","Tis","Ons","Tors","Fre","Lör","Sön"],daysMin:["Sö","Må","Ti","On","To","Fr","Lö","Sö"],months:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"]},isLeapYear:function(t){return t%4===0&&t%100!==0||t%400===0},getDaysInMonth:function(t,e){return[31,i.isLeapYear(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},parseFormat:function(t){var e=t.match(/[.\/\-\s].*?/),i=t.split(/\W+/);if(!e||!i||0===i.length)throw new Error("Invalid date format.");return{separator:e,parts:i}},parseDate:function(t,e){var i,s=t.split(e.separator),t=new Date;if(t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),s.length===e.parts.length){for(var a=t.getFullYear(),n=t.getDate(),h=t.getMonth(),o=0,r=e.parts.length;r>o;o++)switch(i=parseInt(s[o],10)||1,e.parts[o]){case"dd":case"d":n=i,t.setDate(i);break;case"mm":case"m":h=i-1,t.setMonth(i-1);break;case"yy":a=2e3+i,t.setFullYear(2e3+i);break;case"yyyy":a=i,t.setFullYear(i)}t=new Date(a,h,n,0,0,0)}return t},formatDate:function(t,e){var i={d:t.getDate(),m:t.getMonth()+1,yy:t.getFullYear().toString().substring(2),yyyy:t.getFullYear()};i.dd=(i.d<10?"0":"")+i.d,i.mm=(i.m<10?"0":"")+i.m;for(var t=[],s=0,a=e.parts.length;a>s;s++)t.push(i[e.parts[s]]);return t.join(e.separator)},headTemplate:'<thead><tr><th class="prev">&lsaquo;</th><th colspan="5" class="switch"></th><th class="next">&rsaquo;</th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>'};i.template='<div class="datepicker-bt dropdown-menu"><div class="datepicker-bt-days"><table class=" table-condensed">'+i.headTemplate+'<tbody></tbody></table></div><div class="datepicker-bt-months"><table class="table-condensed">'+i.headTemplate+i.contTemplate+'</table></div><div class="datepicker-bt-years"><table class="table-condensed">'+i.headTemplate+i.contTemplate+"</table></div></div>"}(window.jQuery),Object.size=function(t){var e,i=0;for(e in t)t.hasOwnProperty(e)&&i++;return i};